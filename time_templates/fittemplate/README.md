Where the magic happens. Fitting templates 
